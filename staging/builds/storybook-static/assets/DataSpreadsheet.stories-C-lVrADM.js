import{y as Z,p as ue,j as $,q as kt,E as Ce,F as Lt,G as Pt,H as Nt}from"./settings-K-okNOOf.js";import{r as w,R as Vt}from"./index-CTjT7uj6.js";import{useMDXComponents as yt}from"./index-DSkyVWTJ.js";import"./chunk-HLWAVYOI-CelMkzh-.js";import{e as Wt,i as Bt,C as zt}from"./index-Cf6dYWJP.js";import{d as ae,a as me,i as et,h as Et,b as Ut,F as Kt,s as gt,u as Ft,r as Be}from"./useMultipleKeyTracking-B0oVusEa.js";import{P as c}from"./index-BRV0Se7Z.js";import{c as ie}from"./deprecate-BLSDO8J_.js";import{u as $e}from"./uuidv4-BQrI85uz.js";import{p as Oe}from"./props-helper-BHboZCEP.js";import{u as Le}from"./usePreviousValue-BqVTtLed.js";import{g as Xt}from"./devtools-Bwmhsu0A.js";import"./index-BU4hwJwl.js";import"./events-D0gen66i.js";import"./index-DN5spsdJ.js";import"./iframe-ZAk7Pddq.js";import"../sb-preview/runtime.js";import"./react-18-BLKOY-yY.js";import"./extends-CCbyfPlC.js";import"./index-C2eUe6cH.js";import"./inheritsLoose-SLCf_n8R.js";import"./toString-Cu7nsjnZ.js";import"./isSymbol-D87B3_a6.js";import"./index-D4-blIwu.js";import"./index-DrFu-skq.js";const Gt=()=>{const[e,t]=w.useState(document.activeElement),a=()=>{t(document.activeElement)};return w.useEffect(()=>(document.addEventListener("focusin",a),()=>{document.removeEventListener("focusin",a)}),[]),e},ge=e=>{const t=Math.max(e.point1.row,e.point2.row),a=Math.max(e.point1.column,e.point2.column),r=Math.min(e.point1.row,e.point2.row),s=Math.min(e.point1.column,e.point2.column);return{greatestRowIndex:t,greatestColumnIndex:a,lowestColumnIndex:s,lowestRowIndex:r}},tt=({ref:e,area:t,blockClass:a,defaultColumn:r,selectionAreas:s,setSelectionAreas:l,setActiveCellInsideSelectionArea:o,visibleColumns:m})=>{const{lowestColumnIndex:u,lowestRowIndex:y,greatestColumnIndex:p,greatestRowIndex:g}=ge(t);(g-y>0||p-u>0)&&(o(!0),e.current.querySelector(`.${a}__active-cell--highlight`).setAttribute("data-selection-id",t.matcher));let d=0;m.forEach((H,k)=>{k>=u&&k<=p&&(d+=(H==null?void 0:H.width)||(r==null?void 0:r.width))});const i=(document.querySelector(`[data-row-index="${t.point1.row}"][data-column-index="${t.point1.column}"]`)||document.querySelector(`.${a}__body--td`)).offsetHeight,_=i*(g-y+1),M=document.querySelector(`.${a}__list--container`).firstElementChild,x=M.querySelector(`[data-row-index="${y}"][data-column-index="${u}"]`),D={top:x?x.getBoundingClientRect().top-M.getBoundingClientRect().top:y===0?0:i*y,left:x?x.getBoundingClientRect().left-M.getBoundingClientRect().left:u===0?0+(r.rowHeaderWidth-4):r.width*u+(r.rowHeaderWidth-4)},I=document.querySelector(`[data-matcher-id="${t.matcher}"]`)||document.createElement("div");I.classList.add(`${a}__selection-area--element`),I.setAttribute("data-matcher-id",t.matcher),I.style.width=Z(d),I.style.height=Z(_),I.style.left=Z(D.left),I.style.top=Z(D.top),M.appendChild(I);const q=ae(s),n=q.findIndex(H=>H.matcher===t.matcher);q[n].areaCreated=!0,l(q)},ze=(e,t,a)=>{const r=ae(t),s=[];r.forEach(o=>{var y,p,g,d;const m=Math.max((y=o.point1)==null?void 0:y[a],(p=o.point2)==null?void 0:p[a]),u=Math.min((g=o.point1)==null?void 0:g[a],(d=o.point2)==null?void 0:d[a]);for(let A=u;A<=m;A++)s.push(A)});const l=[...new Set(s)];return!!(r!=null&&r.length&&l.includes(e))},bt=(e,t,a,r)=>ae(t).some(o=>{var A,i,_,M,x,D,I,q;const m=a==="column"?"row":"column",u=Math.min((A=o==null?void 0:o.point1)==null?void 0:A[m],(i=o==null?void 0:o.point2)==null?void 0:i[m]),y=Math.max((_=o==null?void 0:o.point1)==null?void 0:_[m],(M=o==null?void 0:o.point2)==null?void 0:M[m]),p=Math.min((x=o==null?void 0:o.point1)==null?void 0:x[a],(D=o==null?void 0:o.point2)==null?void 0:D[a]),g=Math.max((I=o==null?void 0:o.point1)==null?void 0:I[a],(q=o==null?void 0:o.point2)==null?void 0:q[a]),d=(r==null?void 0:r.length)-1===y&&u===0;for(let n=p;n<=g;n++)if(e===n&&d)return!0;return!1}),xt=({type:e,headerGroup:t,scrollBarSizeValue:a,totalVisibleColumns:r,defaultColumn:s,totalColumnsWidth:l,visibleColumns:o})=>{const m=a+s.rowHeaderWidth;if(!r){if(e==="header")return Z(parseInt(t.getHeaderGroupProps().style.width)+m);if(e!=="header")return l+m}if(r)return o.map((y,p)=>p<=r-1&&((y==null?void 0:y.width)||(s==null?void 0:s.width))).reduce((y,p)=>y+p,0)+m},Jt=({spreadsheetRef:e,activeCellCoordinates:t,containerHasFocus:a,createActiveCell:r,activeCellContent:s,isActiveHeaderCellChanged:l})=>{let o;w.useEffect(()=>{o()},[s,o,l]),o=w.useCallback(()=>{const m=e==null?void 0:e.current.querySelector(`[data-row-index="${t==null?void 0:t.row}"][data-column-index="${t==null?void 0:t.column}"]`),u=(t==null?void 0:t.row)==="header"&&!0,y=e==null?void 0:e.current.querySelector('[data-row-index="header"][data-column-index="header"]');a&&r({placementElement:t?m:y,coords:t,addToHeader:u})},[e,t,a,r])},Qt=({blockClass:e=`${ue.prefix}--data-spreadsheet`,focusedElement:t,removeActiveCell:a,setContainerHasFocus:r})=>{w.useEffect(()=>{t.classList.contains(`${e}--interactive-cell-element`)||(r(!1),a()),(t.classList.contains(e)||t.classList.contains(`${e}--interactive-cell-element`))&&r(!0)},[t,a,e,r])},Yt=({spreadsheetRef:e,blockClass:t=`${ue.prefix}--data-spreadsheet`,setActiveCellCoordinates:a,setSelectionAreas:r,removeActiveCell:s,setContainerHasFocus:l,removeCellEditor:o})=>{w.useEffect(()=>{const m=u=>{!e.current||e.current.contains(u.target)||u.target.classList.contains(`${t}__active-cell--highlight`)||u.target.classList.contains(`${t}--interactive-cell-element`)||(a(null),r([]),s(),me({spreadsheetRef:e}),l(!1),o())};return document.addEventListener("click",m),()=>{document.removeEventListener("click",m)}},[e,s,t,a,l,r,o])},Zt=({isEditing:e,rows:t,activeCellCoordinates:a,activeCellRef:r,cellEditorRef:s,cellEditorRulerRef:l,visibleColumns:o,defaultColumn:m,cellEditorValue:u,blockClass:y=`${ue.prefix}--data-spreadsheet`})=>{const[p,g]=w.useState(null),d=Le({nextIndex:p});w.useEffect(()=>{d!=null&&d.nextIndex||g(a==null?void 0:a.column)},[d==null?void 0:d.nextIndex,a]),w.useEffect(()=>{var _,M,x,D,I;const A=l.current.offsetWidth,i=parseInt(s.current.style.width);if(e){const q=(_=t[a==null?void 0:a.row])==null?void 0:_.cells[a==null?void 0:a.column],n=r==null?void 0:r.current.style.left,H=r==null?void 0:r.current.style.top;if(s.current.style.left=n,s.current.style.top=H,s.current.style.display="block",s.current.style.height=r==null?void 0:r.current.style.height,s.current.style.paddingTop=`${(parseInt(r==null?void 0:r.current.style.height)-16)/2-1}px`,s.current.style.textAlign=((M=q==null?void 0:q.column)==null?void 0:M.placement)==="right"?"right":"left",(x=s.current)==null||x.focus(),A<i){const k=((D=o[p])==null?void 0:D.width)||(m==null?void 0:m.width);A<i-k&&(s.current.style.width=Z(parseInt(s.current.style.width)-k),g(j=>j===0?j:j-1))}if(A>=i){g(P=>P===o.length-1?P:P+1);const j=p+1===o.length?0:((I=o[p+1])==null?void 0:I.width)||(m==null?void 0:m.width),F=a==null?void 0:a.row,J=(t.length-F)*m.rowHeight;s.current.style.maxHeight=Z(J),s.current.style.width=Z(j+i),s.current.style.height=Z(s.current.scrollHeight),s.current.clientHeight===J-1?s.current.style.overflow="auto":s.current.style.overflow="hidden"}}e||(s.current.style.overflow="hidden",s.current.style.display="none",s.current.blur(),r.current.focus(),g(a==null?void 0:a.column))},[e,a,t,u,m,r,s,l,o,y,d==null?void 0:d.cellEditorValue,p])},Rt=({currentMatcher:e,setSelectionAreas:t,setClickAndHoldActive:a,setValidStartingPoint:r,validStartingPoint:s,blockClass:l=`${ue.prefix}--data-spreadsheet`,ref:o,setHeaderCellHoldActive:m,setColumnOrder:u,visibleColumns:y,setActiveCellCoordinates:p,activeCellCoordinates:g,rows:d,defaultColumn:A,selectionAreas:i})=>{w.useEffect(()=>{const _=M=>{if(!s){m(!1);const x=o.current.querySelector(`.${l}__selection-area--element-cloned`);if(!x)return;if(x){const D=M.target.closest(`.${l}--interactive-cell-element`),I=parseInt==null?void 0:parseInt(D==null?void 0:D.getAttribute("data-column-index")),q=parseInt==null?void 0:parseInt(x==null?void 0:x.getAttribute("data-column-index-original")),H=i.filter(B=>(B==null?void 0:B.matcher)===e)[0].header.selectedIndexList;if(!o.current.querySelector(`[data-row-index="header"][data-column-index="${I}"]`))return;const j=o.current.querySelector(`[data-matcher-id="${e}"]`),F=o.current.getBoundingClientRect(),J=o.current.querySelector(`.${l}__list--container`).scrollLeft,P=I<q,h=I>q,V=h?I-q:q-I;if(t(B=>{const N=ae(B);if(q===I)return B;const z=N.findIndex(Y=>Y.matcher===e);if(z===-1)return B;if(!H.includes(I)){const Y=h?H.map(se=>se+V):H.map(se=>se-V);N[z].header.selectedIndexList=Y,N[z].point1.column=Math.min(...Y),N[z].point2.column=Math.max(...Y)}return N}),!H.includes(I)){const B=H.length,N=Math.min(...H),z=y.map(L=>L.id),Y=[...z],se=()=>{const L=[];return H.map(W=>L.push(z[W])),L};Y.splice(N,B);const le=H.findIndex(L=>L===q),fe=I-le;Y.splice(fe,0,...se()),u(Y);const te={...g,column:h?g.column+V:g.column-V};p(te);const ne=Array.from(o.current.querySelectorAll(`.${l}__th--selected-header`))[0].getBoundingClientRect().left-F.left+J,f=P?ne:I===q?j.style.left:ne;j.style.left=Z(f)}const O=o.current.querySelector(`.${l}__reorder-indicator-line`);O==null||O.remove(),x==null||x.remove()}}if(s){a(!1),r(!1);const x=M.target.closest(`.${l}__body--td`);if(x){const D={row:Number(x.getAttribute("data-row-index")),column:Number(x.getAttribute("data-column-index"))};t(I=>{const q=ae(I),n=q.findIndex(H=>H.matcher===e);return n===-1?I:(q[n].point2=D,q[n].areaCreated=!1,q)})}}};return document.addEventListener("mouseup",_),()=>{document.removeEventListener("mouseup",_)}},[l,e,t,a,r,s,o,m,u,y,p,g,d,A,i])},vt=({blockClass:e=`${ue.prefix}--data-spreadsheet`,clonedSelectionElement:t,ref:a,spreadsheetCoords:r,leftScrollAmount:s})=>{const l=event.target.closest(`.${e}--interactive-cell-element`),o=l==null?void 0:l.getAttribute("data-column-index"),m=t==null?void 0:t.getAttribute("data-column-index-original"),u=l.getBoundingClientRect(),y=a.current.querySelector(`.${e}__reorder-indicator-line`),p=t==null?void 0:t.getAttribute("data-matcher-id"),g=a.current.querySelector(`[data-matcher-id="${p}"]`);Number(o)>Number(m)&&(y.style.left=Z(u.left-r.left+l.offsetWidth-2+s)),Number(o)<Number(m)&&(y.style.left=Z(u.left-r.left+s)),Number(o)===Number(m)&&(y.style.left=g.style.left)},Ct=({ref:e,blockClass:t=`${ue.prefix}--data-spreadsheet`,headerCellHoldActive:a,defaultColumn:r})=>{w.useEffect(()=>{const s=o=>{const m=e.current.querySelector(`.${t}__selection-area--element-cloned`);m&&e.current.addEventListener("mousemove",s);const u=e.current.getBoundingClientRect(),y=e.current.querySelector(`.${t}__list--container`),p=y.scrollLeft;vt({clonedSelectionElement:m,ref:e,spreadsheetCoords:u,leftScrollAmount:p}),e.current.getBoundingClientRect();const d=o.clientX-u.left,A=m==null?void 0:m.getAttribute("data-clone-offset-x"),i=y.scrollWidth,_=m.offsetWidth,M=Math.max(d-A,r==null?void 0:r.rowHeaderWidth);m.style.left=Z(i-_>=M?M+p:i-_)};a&&e.current.addEventListener("mousemove",s);const l=e.current;return a||l==null||l.removeEventListener("mousemove",s),()=>{l==null||l.removeEventListener("mousemove",s)}})},He=(e,t)=>t=="cmd"?e.metaKey||e.ctrlKey:e[t],en=({indexList:e,newIndex:t,activeCellIndex:a})=>{const r=t>a?a:Math.min(...e,t),s=t<a?a:Math.max(...e,t),l=[];for(let o=r;o<=s;o++)l.push(o);return[...l]},ke=({type:e,activeCellCoordinates:t,rows:a,columns:r,currentMatcher:s,setActiveCellCoordinates:l,setCurrentMatcher:o,setSelectionAreas:m,spreadsheetRef:u,index:y,isKeyboard:p,setSelectionAreaData:g,isHoldingCommandKey:d,isHoldingShiftKey:A})=>{d||(g([]),me({spreadsheetRef:u}));const i=p?t==null?void 0:t.row:y,_=p?t==null?void 0:t.column:y,M={row:e==="column"?0:i,column:e==="column"?_:0},x={row:e==="column"?a.length-1:i,column:e==="column"?_:r.length-1},D=$e();A||(l({row:e==="column"?0:i,column:e==="column"?_:0}),o(D));const I={point1:M,point2:x,areaCreated:!1,matcher:D,header:{type:e,selectedIndexList:[e==="column"?_:i]}};m(q=>{var H,k;const n=ae(q);if(d){const F=n.filter(J=>{var P;return(P=J.header)==null?void 0:P.type}).filter(J=>{var P;return((P=J.header)==null?void 0:P.type)===e}),ee=ze(y,F,e);return F.length&&ee?q:[...q,I]}if(A){const F=n.filter(z=>{var Y;return(Y=z.header)==null?void 0:Y.type}).filter(z=>z.matcher===s)[0],ee=Math.max(F==null?void 0:F.point1[e],F==null?void 0:F.point2[e],t==null?void 0:t[e]),J=e==="column"?_:i,P={row:ee<J?a.length-1:0,column:_},h=ae(q),V=h.findIndex(z=>z.matcher===s),O=en({indexList:((k=(H=h[V])==null?void 0:H.header)==null?void 0:k.selectedIndexList)||[e==="column"?_:i],newIndex:J,activeCellIndex:t==null?void 0:t[e]}),B=z=>z<J?{row:e==="column"?0:Math.min(...O),column:e==="column"?Math.min(...O):0}:P,N=z=>z<J?P:{row:e==="column"?a.length-1:Math.max(...O),column:e==="column"?Math.max(...O):r.length-1};if(!t||typeof t>"u"){o(D);const z={point1:B(e==="column"?_:i),point2:N(e==="column"?_:i),areaCreated:!1,matcher:D,header:{type:e,selectedIndexList:[e==="column"?_:i]}};return l({row:e==="column"?0:i,column:e==="column"?_:0}),[z]}return h[V].point1=B(t==null?void 0:t[e]),h[V].point2=N(t==null?void 0:t[e]),h[V].areaCreated=!1,h[V].header.selectedIndexList=O,h}return[I]})},tn=({activeCellInsideSelectionArea:e,activeCellCoordinates:t,activeCellRef:a,selectionAreas:r,updateActiveCellCoordinates:s})=>{if(!e)return;const l=a.current.getAttribute("data-selection-id"),o=r.findIndex(A=>A.matcher===l),m=r[o],{lowestColumnIndex:u,lowestRowIndex:y,greatestColumnIndex:p,greatestRowIndex:g}=ge(m),d={...t};if((t==null?void 0:t.row)<g&&s({coords:d,updatedValue:{row:(d==null?void 0:d.row)+1},optOutOfSelectionAreaUpdate:!0}),(t==null?void 0:t.row)===g&&((t==null?void 0:t.column)<p&&s({coords:d,updatedValue:{column:(d==null?void 0:d.column)+1,row:y},optOutOfSelectionAreaUpdate:!0}),(t==null?void 0:t.column)===p)){if(r.length>1)if(r[o+1]){a.current.setAttribute("data-selection-id",r[o+1].matcher);const A=r[o+1],{lowestColumnIndex:i,lowestRowIndex:_}=ge(A);s({coords:d,updatedValue:{column:i,row:_},optOutOfSelectionAreaUpdate:!0});return}else{a.current.setAttribute("data-selection-id",r[0].matcher);const A=r[0],{lowestColumnIndex:i,lowestRowIndex:_}=ge(A);s({coords:d,updatedValue:{column:i,row:_},optOutOfSelectionAreaUpdate:!0})}if(r.length===1)return s({coords:d,updatedValue:{column:u,row:y},optOutOfSelectionAreaUpdate:!0})}},nn=({activeCellInsideSelectionArea:e,activeCellCoordinates:t,activeCellRef:a,selectionAreas:r,updateActiveCellCoordinates:s})=>{if(!e)return;const l=a.current.getAttribute("data-selection-id"),o=r.findIndex(d=>d.matcher===l),m=r[o],{lowestColumnIndex:u,lowestRowIndex:y,greatestColumnIndex:p,greatestRowIndex:g}=ge(m);if((t==null?void 0:t.column)<p&&s({updatedValue:{column:(t==null?void 0:t.column)+1},optOutOfSelectionAreaUpdate:!0}),(t==null?void 0:t.column)===p&&((t==null?void 0:t.row)<g&&s({updatedValue:{column:u,row:(t==null?void 0:t.row)+1},optOutOfSelectionAreaUpdate:!0}),(t==null?void 0:t.row)===g)){if(r.length>1)if(r[o+1]){a.current.setAttribute("data-selection-id",r[o+1].matcher);const d=r[o+1],{lowestColumnIndex:A,lowestRowIndex:i}=ge(d);s({updatedValue:{column:A,row:i},optOutOfSelectionAreaUpdate:!0});return}else{a.current.setAttribute("data-selection-id",r[0].matcher);const d=r[0],{lowestColumnIndex:A,lowestRowIndex:i}=ge(d);s({updatedValue:{column:A,row:i},optOutOfSelectionAreaUpdate:!0})}if(r.length===1)return s({updatedValue:{column:u,row:y},optOutOfSelectionAreaUpdate:!0})}},nt=(e,t,a)=>{for(let r=e;r<=t;r++)a(r)},rn=({activeCellCoordinates:e,selectionAreas:t,currentMatcher:a,rows:r,setActiveCellContent:s,updateData:l})=>{var A,i,_,M,x,D,I,q;if((e==null?void 0:e.column)==="header"||(e==null?void 0:e.row)==="header")return;const o=ae(t),m=o.findIndex(n=>n.matcher===a),u=o[m],y=Math.min((A=u==null?void 0:u.point1)==null?void 0:A.column,(i=u==null?void 0:u.point2)==null?void 0:i.column),p=Math.max((_=u==null?void 0:u.point1)==null?void 0:_.column,(M=u==null?void 0:u.point2)==null?void 0:M.column),g=Math.min((x=u==null?void 0:u.point1)==null?void 0:x.row,(D=u==null?void 0:u.point2)==null?void 0:D.row),d=Math.max((I=u==null?void 0:u.point1)==null?void 0:I.row,(q=u==null?void 0:u.point2)==null?void 0:q.row);nt(y,p,n=>{nt(g,d,H=>{const k=r[H].cells[n];l(H,k==null?void 0:k.column.id,"")})}),s(null)},je=`${ue.prefix}--data-spreadsheet`,an=(e,t,a,...r)=>{const[s,l,o,m,u,y,p,g,d,A,i,_,M]=r;a.preventDefault();const D=a.target.closest(`.${je}__body--td`).classList.contains(`${je}__body--td`);M(D);const I=He(a,"cmd"),q=He(a,"shiftKey");y(!0);const n={row:e.row.index,column:t},H=$e();if(p(!0),I)d.current.querySelector(`.${je}__active-cell--highlight`).setAttribute("data-selection-id",H),i(!0),m(n),g(H),u(j=>[...j,{point1:n,matcher:H}]);else if(q){y(!0);const k=ae(o),j=k.findIndex(F=>F.matcher===s);if(j===-1)return;k[j].point1=l,k[j].point2=n,k[j].areaCreated=!1,k[j].matcher=s,u(k)}else _.current.style.display="none",i(!1),m(n),me({spreadsheetRef:d}),u([{point1:n,matcher:H}]),g(H),A([])},sn=(e,t,...a)=>{const[r,s,l]=a;if(r){const o={row:e.row.index,column:t};l(m=>{var p,g;const u=ae(m),y=u.findIndex(d=>d.matcher===s);return y===-1||((p=u[y].point2)==null?void 0:p.row)===o.row&&((g=u[y].point2)==null?void 0:g.column)===o.column?m:(u[y].point2=o,u[y].areaCreated=!1,u)})}},on=(e,t,...a)=>{const[r,s,l,o,m,u,y,p]=a,g=He(t,"cmd");ke({type:"row",activeCellCoordinates:u,rows:y,columns:r,setActiveCellCoordinates:m,setCurrentMatcher:o,setSelectionAreas:l,spreadsheetRef:s,index:e,setSelectionAreaData:p,isHoldingCommandKey:g})},cn=(e,...t)=>{const[a,r,s,l,o,m,u,y,p,g,d,A,i,_,M,x,D,I,q,n,H,k,j]=t,{key:F}=e;if(!M(F)&&(["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].indexOf(F)>-1&&g!=null&&g.length&&A.length<2&&!et(A)&&(D([]),I([]),me({spreadsheetRef:u})),(A==null?void 0:A.length)>1&&Et({activeCellCoordinates:s,event:e,keysPressedList:A,selectionAreas:g,currentMatcher:y,rows:m,setSelectionAreas:D,columns:o,updateActiveCellCoordinates:r,spreadsheetRef:u,removeCellSelections:me,blockClass:je,setCurrentMatcher:q,usingMac:i}),A.length<2&&!et(A)||s.row==="header"||s.column==="header"))switch(F){case"Backspace":case"Delete":{rn({selectionAreas:g,currentMatcher:y,rows:m,setActiveCellContent:j,updateData:_,activeCellCoordinates:s});break}case"Enter":{tn({activeCellInsideSelectionArea:a,activeCellCoordinates:s,activeCellRef:n,selectionAreas:g,updateActiveCellCoordinates:r});break}case"Home":case"End":{if(e.preventDefault(),Ut(A,i))return;d({type:F});break}case"Tab":{if(a)return e.preventDefault(),nn({activeCellInsideSelectionArea:a,activeCellCoordinates:s,activeCellRef:n,selectionAreas:g,updateActiveCellCoordinates:r});D([]),l(),p(),k(!1),H(null);break}case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":x(F)}},X=`${ue.prefix}--data-spreadsheet`,Ee=w.forwardRef(({activeCellRef:e,columns:t,activeCellCoordinates:a,defaultColumn:r,defaultEmptyRowCount:s,getTableBodyProps:l,headerGroups:o,id:m,onDataUpdate:u,prepareRow:y,rows:p,selectionAreaData:g,setSelectionAreaData:d,setActiveCellCoordinates:A,selectionAreas:i,setContainerHasFocus:_,setSelectionAreas:M,scrollBarSize:x,totalColumnsWidth:D,clickAndHoldActive:I,setClickAndHoldActive:q,currentMatcher:n,setCurrentMatcher:H,onSelectionAreaChange:k,setActiveCellInsideSelectionArea:j,totalVisibleColumns:F,setHeaderCellHoldActive:ee,setColumnOrder:J,visibleColumns:P},h)=>{const[V,O]=w.useState(!1),B=w.useRef(),N=Le({selectionAreaData:g,clickAndHoldActive:I,rowHeight:r==null?void 0:r.rowHeight})||{};w.useEffect(()=>{h==null||h.current.style.setProperty(`--${X}--total-width`,Z((D||0)+(x||0)))},[h,x,D]),w.useEffect(()=>{var f;g!=null&&g.length&&(!I&&(N!=null&&N.clickAndHoldActive)||((f=N==null?void 0:N.selectionAreaData)==null?void 0:f.length)!==(g==null?void 0:g.length))&&(k==null||k(g))},[N==null?void 0:N.selectionAreaData,g,k,I,N==null?void 0:N.clickAndHoldActive]),w.useEffect(()=>{i&&i.length&&i.map(f=>{if(f.areaCreated){const L=Math.min(f.point1.row,f.point2.row),W=Math.max(f.point1.row,f.point2.row),U=Math.min(f.point1.column,f.point2.column),T=Math.max(f.point1.column,f.point2.column),E={rows:{start:L,end:W},columns:{start:U,end:T},cells:z({rowStart:L,rowEnd:W,columnStart:U,columnEnd:T}),selectionId:f.matcher};d==null||d(oe=>[...ae(oe).filter(Ve=>Ve.selectionId!==f.matcher),E])}!f.areaCreated&&f.point1&&f.point2&&f.matcher&&tt({ref:h,area:f,blockClass:X,defaultColumn:r,selectionAreas:i,setSelectionAreas:M,setActiveCellInsideSelectionArea:j,visibleColumns:P})})},[i,M,r,k,d,h,a,j,P]);const z=({rowStart:f,rowEnd:L,columnStart:W,columnEnd:U})=>{const T=[];for(let E=f;E<=L;E++)for(let oe=W;oe<=U;oe++)T.push([E,oe,`${X}__cell--${E}--${oe}`]);return T};Rt({currentMatcher:n,setClickAndHoldActive:q,setSelectionAreas:M,setValidStartingPoint:O,validStartingPoint:V,ref:h,setHeaderCellHoldActive:ee,setColumnOrder:J,visibleColumns:P,setActiveCellCoordinates:A,rows:p,activeCellCoordinates:a,defaultColumn:r,selectionAreas:i}),w.useEffect(()=>{let f,L;if(ne!=null&&ne.current&&(f=ne==null?void 0:ne.current,L=f==null?void 0:f.querySelector(`.${X}__active-cell--highlight`)),L&&(r==null?void 0:r.rowHeight)!==N.rowHeight&&(L.style.height=`${r==null?void 0:r.rowHeight}px`,a)){const W=h==null?void 0:h.current.querySelector(`[data-row-index="${a.row}"][data-column-index="${a.column}"]`),U=h==null?void 0:h.current.querySelector(`.${X}__list--container`);let T;W&&U&&(T=(W==null?void 0:W.getBoundingClientRect().top)-U.getBoundingClientRect().top),L.style.top=Z(T),me({matcher:void 0,spreadsheetRef:h}),i==null||i.map(E=>{if(!E.areaCreated&&E.point1&&E.point2&&E.matcher)return tt({ref:h,area:E,blockClass:X,defaultColumn:r,selectionAreas:i,setSelectionAreas:M,setActiveCellInsideSelectionArea:j,visibleColumns:P})})}},[r,h,a,N==null?void 0:N.rowHeight,i,j,M,P]);const Y=w.useCallback(()=>{const f=[],L=[];h==null||h.current.querySelectorAll(`.${X}__selection-area--element`).forEach(W=>{const{top:U,left:T,height:E,width:oe}=W.style,he=`${U}${T}${E}${oe}`;f.indexOf(he)==-1?f.push(he):(W.remove(),L.push(W.getAttribute("data-matcher-id")))}),L.length&&(M==null||M(W=>ae(W).filter(T=>!L.includes(T.matcher))),d==null||d(W=>ae(W).filter(T=>!L.includes(T.selectionId))))},[h,M,d]);w.useEffect(()=>{Y()},[i,Y]);const se=w.useCallback((f,L)=>W=>{an(f,L,W,n,a,i,A,M,_,q,H,h,d,j,e,O)},[n,a,i,A,M,_,q,H,h,d,j,e]),le=()=>{const f=h.current.querySelector(`
        .${X}__header--container .${X}__tr`)||new HTMLDivElement;f.scrollLeft=B==null?void 0:B.current.scrollLeft};w.useEffect(()=>{B.current.addEventListener("scroll",()=>le());const f=B.current||new HTMLElement;return()=>{f.removeEventListener("scroll",le)}});const fe=w.useCallback((f,L)=>()=>{sn(f,L,I,n,M)},[I,n,M]),te=w.useCallback(f=>L=>{on(f,L,t,h,M,H,A,a,p,d)},[t,h,M,H,A,a,p,d]);w.useEffect(()=>{p!=null&&p.length||(()=>{const L=[];[...Array(s)].map(()=>{var U;const W={};(U=o==null?void 0:o[0])==null||U.headers.map(T=>{W[T.id]=null}),L.push(W)}),u==null||u(L)})()},[p,o,s,u]);const ce=()=>$.jsx("div",{}),Q=w.useCallback(({index:f,style:L})=>{const W=p==null?void 0:p[f];if(p&&p.length){y==null||y(W);const U=Oe(W.getRowProps({style:L}),"key");return $.jsxs("div",{...U,className:ie(`${X}__tr`),"data-row-index":f,"aria-rowindex":f+1,"aria-owns":`${X}__cell-editor-text-area`,children:[$.jsx("div",{role:"rowheader",className:`${X}__td-th--cell-container`,children:$.jsx("button",{id:`${X}__cell--${f}--header`,tabIndex:-1,"data-row-index":f,"data-column-index":"header",type:"button",onClick:te(f),className:ie(`${X}__td`,`${X}__td-th`,`${X}--interactive-cell-element`,{[`${X}__td-th--active-header`]:(a==null?void 0:a.row)===f||ze(f,i,"row"),[`${X}__td-th--selected-header`]:bt(f,i,"row",t)}),style:{width:r==null?void 0:r.rowHeaderWidth},children:f+1})}),W.cells.map((T,E)=>{var he;const oe=Oe(T.getCellProps(),"key");return $.jsx("div",{"aria-colindex":E+1,...oe,role:"gridcell",style:{...T.getCellProps().style,display:"grid",minWidth:((he=T==null?void 0:T.column)==null?void 0:he.width)||(r==null?void 0:r.width)},children:$.jsx("button",{id:`${X}__cell--${T.row.index}--${E}`,tabIndex:-1,"data-row-index":T.row.index,"data-column-index":E,className:ie(`${X}__td`,`${X}__body--td`,`${X}--interactive-cell-element`),onMouseDown:se(T,E),onMouseOver:fe(T,E),onFocus:()=>{},type:"button",children:T.render("Cell")})},`cell_${E}`)})]},{...W.getRowProps().key})}},[y,p,a==null?void 0:a.row,i,te,se,fe,r,t]),ne=w.useRef();return $.jsx("div",{ref:ne,className:ie(`${X}__body--container`),...l==null?void 0:l(),children:$.jsx(Kt,{className:ie(`${X}__list--container`,`${X}__list--container--${m}`),height:400,itemCount:(p==null?void 0:p.length)||s,itemSize:r==null?void 0:r.rowHeight,width:xt({headerGroup:void 0,type:void 0,scrollBarSizeValue:x,totalVisibleColumns:F,defaultColumn:r,totalColumnsWidth:D,visibleColumns:P}),outerRef:B,children:p!=null&&p.length?Q:ce})})});Ee.propTypes={activeCellCoordinates:c.shape({row:c.oneOfType([c.string,c.number]),column:c.oneOfType([c.string,c.number])}),activeCellRef:c.object,clickAndHoldActive:c.bool,columns:c.array,currentMatcher:c.string,defaultColumn:c.shape({rowHeight:c.number,rowHeaderWidth:c.number,width:c.number}),defaultEmptyRowCount:c.number,getTableBodyProps:c.func,headerGroups:c.arrayOf(c.object),id:c.oneOfType([c.number,c.string]),onActiveCellChange:c.func,onDataUpdate:c.func,onSelectionAreaChange:c.func,prepareRow:c.func,rows:c.arrayOf(c.object),scrollBarSize:c.number,selectionAreaData:c.array,selectionAreas:c.array,setActiveCellCoordinates:c.func,setActiveCellInsideSelectionArea:c.func,setClickAndHoldActive:c.func,setColumnOrder:c.func,setContainerHasFocus:c.func,setCurrentMatcher:c.func,setHeaderCellHoldActive:c.func,setSelectionAreaData:c.func,setSelectionAreas:c.func,totalColumnsWidth:c.number,totalVisibleColumns:c.number,visibleColumns:c.array};Ee.__docgenInfo={description:"",methods:[],displayName:"DataSpreadsheetBody",props:{activeCellCoordinates:{required:!1,tsType:{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]},description:"Object containing the active cell coordinates",type:{name:"shape",value:{row:{name:"union",value:[{name:"string"},{name:"number"}],required:!1},column:{name:"union",value:[{name:"string"},{name:"number"}],required:!1}}}},activeCellRef:{required:!1,tsType:{name:"MutableRefObject",elements:[{name:"union",raw:"HTMLElement | undefined",elements:[{name:"HTMLElement"},{name:"undefined"}]}],raw:"MutableRefObject<HTMLElement | undefined>"},description:"This is the ref of the button input, which is the active cell element",type:{name:"object"}},clickAndHoldActive:{required:!1,tsType:{name:"boolean"},description:"Is the user clicking and holding in the data spreadsheet body",type:{name:"bool"}},columns:{required:!1,tsType:{name:"unknown"},description:"All of the spreadsheet columns",type:{name:"array"}},currentMatcher:{required:!1,tsType:{name:"string"},description:"This represents the id of the current cell selection area",type:{name:"string"}},defaultColumn:{required:!1,tsType:{name:"SpreadsheetColumn"},description:"Default spreadsheet sizing values",type:{name:"shape",value:{rowHeight:{name:"number",required:!1},rowHeaderWidth:{name:"number",required:!1},width:{name:"number",required:!1}}}},defaultEmptyRowCount:{required:!1,tsType:{name:"number"},description:"Sets the number of empty rows to be created when there is no data provided",type:{name:"number"}},getTableBodyProps:{required:!1,tsType:{name:"signature",type:"function",raw:"(propGetter?: TableBodyPropGetter<any>) => TableBodyProps",signature:{arguments:[{type:{name:"TableBodyPropGetter",elements:[{name:"any"}],raw:"TableBodyPropGetter<any>"},name:"propGetter"}],return:{name:"TableBodyProps"}}},description:"Function to set table body prop values",type:{name:"func"}},headerGroups:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Headers provided from useTable hook",type:{name:"arrayOf",value:{name:"object"}}},id:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"The spreadsheet id",type:{name:"union",value:[{name:"number"},{name:"string"}]}},onActiveCellChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the active cell changes",type:{name:"func"}},onDataUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The event handler that is called to set the rows for the empty spreadsheet",type:{name:"func"}},onSelectionAreaChange:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The event handler that is called when the selection areas change",type:{name:"func"}},prepareRow:{required:!1,tsType:{name:"signature",type:"function",raw:"(...args) => void",signature:{arguments:[{name:"args",rest:!0}],return:{name:"void"}}},description:"Prepare row function from react-table",type:{name:"func"}},rows:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"All of the spreadsheet row data",type:{name:"arrayOf",value:{name:"object"}}},scrollBarSize:{required:!1,tsType:{name:"number"},description:"The scrollbar width",type:{name:"number"}},selectionAreaData:{required:!1,tsType:{name:"Array",elements:[{name:"object"}],raw:"object[]"},description:"Array of selection area data",type:{name:"array"}},selectionAreas:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Array of selection areas",type:{name:"array"}},setActiveCellCoordinates:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]}],raw:"SetStateAction<ActiveCellCoordinates | null>"}],raw:`Dispatch<
  SetStateAction<ActiveCellCoordinates | null>
>`},description:"Setter fn for activeCellCoordinates state value",type:{name:"func"}},setActiveCellInsideSelectionArea:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for active cell inside of selection area",type:{name:"func"}},setClickAndHoldActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for clickAndHold state value",type:{name:"func"}},setColumnOrder:{required:!1,tsType:{name:"signature",type:"function",raw:`(
  updater:
    | ((columnOrder: Array<IdType<any>>) => Array<IdType<any>>)
    | Array<IdType<any>>
) => void`,signature:{arguments:[{type:{name:"union",raw:`| ((columnOrder: Array<IdType<any>>) => Array<IdType<any>>)
| Array<IdType<any>>`,elements:[{name:"unknown"},{name:"Array",elements:[{name:"IdType",elements:[{name:"any"}],raw:"IdType<any>"}],raw:"Array<IdType<any>>"}]},name:"updater"}],return:{name:"void"}}},description:"Setter fn for column ordering, provided from react-table",type:{name:"func"}},setContainerHasFocus:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for containerHasFocus state value",type:{name:"func"}},setCurrentMatcher:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"string"}],raw:"SetStateAction<string>"}],raw:"Dispatch<SetStateAction<string>>"},description:"Setter fn for currentMatcher state value",type:{name:"func"}},setHeaderCellHoldActive:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"boolean"}],raw:"SetStateAction<boolean>"}],raw:"Dispatch<SetStateAction<boolean>>"},description:"Setter fn for header cell hold active value",type:{name:"func"}},setSelectionAreaData:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreaData state value",type:{name:"func"}},setSelectionAreas:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreas state value",type:{name:"func"}},totalColumnsWidth:{required:!1,tsType:{name:"number"},description:"The total columns width",type:{name:"number"}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}},visibleColumns:{required:!1,tsType:{name:"Array",elements:[{name:"Column",elements:[{name:"object"}],raw:"Column<object>"}],raw:"Column<object>[]"},description:"Prop from react-table used to reorder columns",type:{name:"array"}}}};const C=`${ue.prefix}--data-spreadsheet`,Ue=w.forwardRef(({activeCellCoordinates:e,cellSize:t,columns:a,currentMatcher:r,defaultColumn:s,headerGroups:l,scrollBarSize:o,selectionAreas:m,setActiveCellCoordinates:u,setCurrentMatcher:y,setSelectionAreas:p,setSelectionAreaData:g,rows:d,totalVisibleColumns:A,updateActiveCellCoordinates:i,setHeaderCellHoldActive:_,headerCellHoldActive:M,selectAllAriaLabel:x,visibleColumns:D},I)=>{const[q,n]=w.useState(0),[H,k]=w.useState(!1),j=Le({cellSize:t})||{};w.useEffect(()=>{var P;if((j==null?void 0:j.cellSize)!==t){const h=(P=I==null?void 0:I.current)==null?void 0:P.querySelector(`.${C}__list--container`),O=(h==null?void 0:h.scrollHeight)&&(h==null?void 0:h.clientHeight)&&(h==null?void 0:h.scrollHeight)>(h==null?void 0:h.clientHeight)?0:o;h!=null&&h.getAttribute("tabIndex")||h==null||h.setAttribute("tabIndex","0"),n(O)}},[t,I,o,j==null?void 0:j.cellSize]);const F=P=>h=>{const V=He(h,"cmd"),O=He(h,"shiftKey");ke({type:"column",activeCellCoordinates:e,rows:d,columns:a,currentMatcher:r,setActiveCellCoordinates:u,setCurrentMatcher:y,setSelectionAreas:p,spreadsheetRef:I,index:P,isKeyboard:void 0,setSelectionAreaData:g,isHoldingCommandKey:V,isHoldingShiftKey:O})},ee=()=>{gt({ref:I,setCurrentMatcher:y,setSelectionAreas:p,rows:d,columns:a,activeCellCoordinates:e,updateActiveCellCoordinates:i})},J=P=>h=>{var ne,f,L,W,U,T;if(h.shiftKey)return;k(!0);const V=m==null?void 0:m.filter(E=>(E==null?void 0:E.matcher)===r),O=I.current.querySelector(`[data-matcher-id="${(ne=V==null?void 0:V[0])==null?void 0:ne.matcher}"]`),B=h.clientX,N=h.target.getBoundingClientRect(),z=h.target.getAttribute("data-column-index"),Y=B-N.left,se=Math.min(((L=(f=V==null?void 0:V[0])==null?void 0:f.point1)==null?void 0:L.column)||0,((U=(W=V==null?void 0:V[0])==null?void 0:W.point2)==null?void 0:U.column)||0),le=(O==null?void 0:O.getBoundingClientRect())||new DOMRect,fe=se<parseInt(z)?Y+(N.left-(le==null?void 0:le.left)):Y,te=(T=document==null?void 0:document.querySelector(`.${C}__list--container`))==null?void 0:T.firstElementChild,ce=O==null?void 0:O.cloneNode(),Q=O==null?void 0:O.cloneNode();Q&&(Q.className=`${C}__reorder-indicator-line`,Q.style.width=Z(2)),ce.classList.add(`${C}__selection-area--element-cloned`),ce.setAttribute("data-clone-offset-x",`${fe}`),ce.setAttribute("data-column-index-original",P),te==null||te.appendChild(ce),te==null||te.appendChild(Q),_==null||_(!0)};return Ct({ref:I,headerCellHoldActive:M,defaultColumn:s}),$.jsx("div",{className:ie(`${C}__header--container`),role:"rowgroup",children:l==null?void 0:l.map((P,h)=>{const V=Oe(P.getHeaderGroupProps(),"key");return $.jsxs("div",{...V,style:{...P.getHeaderGroupProps().style,width:xt({type:"header",headerGroup:P,scrollBarSizeValue:q,totalVisibleColumns:A,defaultColumn:s,totalColumnsWidth:void 0,visibleColumns:D}),overflow:"hidden"},className:`${C}__tr`,children:[$.jsx("div",{role:"columnheader",className:`${C}__select-all-cell-container`,style:{width:s==null?void 0:s.rowHeaderWidth,height:s==null?void 0:s.rowHeight},children:$.jsx("button",{id:`${C}__cell--header--header`,"data-row-index":"header","data-column-index":"header",type:"button",tabIndex:-1,"aria-label":x,onClick:ee,className:ie(`${C}__th`,`${C}--interactive-cell-element`,`${C}__th--select-all`,{[`${C}__th--active-header`]:(e==null?void 0:e.column)==="header"&&(e==null?void 0:e.row)==="header"}),children:"Â "})}),P.headers.map((O,B)=>{const N=Oe(O.getHeaderProps(),"key"),z=bt(B,m,"column",d);return $.jsx("div",{role:"columnheader",className:`${C}__columnheader`,...N,children:$.jsx("button",{id:`${C}__cell--header--${B}`,"data-row-index":"header","data-column-index":B,tabIndex:-1,onMouseDown:z?J(B):void 0,onMouseUp:z?()=>k(!1):void 0,onClick:z?void 0:F(B),style:{height:s==null?void 0:s.rowHeight,width:(O==null?void 0:O.width)||(s==null?void 0:s.width)},className:ie(`${C}__th`,`${C}--interactive-cell-element`,{[`${C}__th--active-header`]:(e==null?void 0:e.column)===B||ze(B,m,"column"),[`${C}__th--selected-header`]:z,[`${C}__th--selected-header-reorder-active`]:H}),type:"button",children:O.render("Header")})},`column_${B}`)})]},`header_${h}`)})})});Ue.propTypes={activeCellCoordinates:c.shape({row:c.oneOfType([c.number,c.string]),column:c.oneOfType([c.number,c.string])}),cellSize:c.oneOf(["xs","sm","md","lg"]),columns:c.array,currentMatcher:c.string,defaultColumn:c.shape({rowHeight:c.number,rowHeaderWidth:c.number,width:c.number}),headerCellHoldActive:c.bool,headerGroups:c.arrayOf(c.object),rows:c.arrayOf(c.object),scrollBarSize:c.number,selectAllAriaLabel:c.string.isRequired,selectionAreas:c.arrayOf(c.object),setActiveCellCoordinates:c.func,setCurrentMatcher:c.func,setHeaderCellHoldActive:c.func,setSelectionAreaData:c.func,setSelectionAreas:c.func,totalVisibleColumns:c.number,updateActiveCellCoordinates:c.func,visibleColumns:c.array};Ue.__docgenInfo={description:"",methods:[],displayName:"DataSpreadsheetHeader",props:{activeCellCoordinates:{required:!1,tsType:{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]},description:"Object containing the active cell coordinates",type:{name:"shape",value:{row:{name:"union",value:[{name:"number"},{name:"string"}],required:!1},column:{name:"union",value:[{name:"number"},{name:"string"}],required:!1}}}},cellSize:{required:!1,tsType:{name:"union",raw:"'xs' | 'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'xs'"},{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"Specifies the cell height",type:{name:"enum",value:[{value:"'xs'",computed:!1},{value:"'sm'",computed:!1},{value:"'md'",computed:!1},{value:"'lg'",computed:!1}]}},columns:{required:!1,tsType:{name:"unknown"},description:"All of the spreadsheet columns",type:{name:"array"}},currentMatcher:{required:!1,tsType:{name:"string"},description:"uuid that corresponds to the current selection area",type:{name:"string"}},defaultColumn:{required:!1,tsType:{name:"SpreadsheetColumn"},description:"Default spreadsheet sizing values",type:{name:"shape",value:{rowHeight:{name:"number",required:!1},rowHeaderWidth:{name:"number",required:!1},width:{name:"number",required:!1}}}},headerCellHoldActive:{required:!1,tsType:{name:"boolean"},description:"Whether or not a click/hold is active on a header cell",type:{name:"bool"}},headerGroups:{required:!1,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:"Headers provided from useTable hook",type:{name:"arrayOf",value:{name:"object"}}},rows:{required:!1,tsType:{name:"Array",elements:[{name:"object"}],raw:"object[]"},description:"All of the spreadsheet row data",type:{name:"arrayOf",value:{name:"object"}}},scrollBarSize:{required:!1,tsType:{name:"number"},description:"The scrollbar width",type:{name:"number"}},selectAllAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Select all button",type:{name:"string"}},selectionAreas:{required:!1,tsType:{name:"Array",elements:[{name:"ItemType"}],raw:"ItemType[]"},description:"All of the cell selection area items",type:{name:"arrayOf",value:{name:"object"}}},setActiveCellCoordinates:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"union",raw:"ActiveCellCoordinates | null",elements:[{name:"ActiveCellCoordinates"},{name:"null"}]}],raw:"SetStateAction<ActiveCellCoordinates | null>"}],raw:`Dispatch<
  SetStateAction<ActiveCellCoordinates | null>
>`},description:"Setter fn for activeCellCoordinates value",type:{name:"func"}},setCurrentMatcher:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"string"}],raw:"SetStateAction<string>"}],raw:"Dispatch<SetStateAction<string>>"},description:"Setter fn for currentMatcher value",type:{name:"func"}},setHeaderCellHoldActive:{required:!1,tsType:{name:"signature",type:"function",raw:"(arg: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"arg"}],return:{name:"void"}}},description:"Setter fn for header cell hold active value",type:{name:"func"}},setSelectionAreaData:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreaData state value",type:{name:"func"}},setSelectionAreas:{required:!1,tsType:{name:"Dispatch",elements:[{name:"SetStateAction",elements:[{name:"Array",elements:[{name:"object"}],raw:"object[]"}],raw:"SetStateAction<object[]>"}],raw:"Dispatch<SetStateAction<object[]>>"},description:"Setter fn for selectionAreas value",type:{name:"func"}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}},updateActiveCellCoordinates:{required:!1,tsType:{name:"signature",type:"function",raw:"(arg) => void",signature:{arguments:[{name:"arg"}],return:{name:"void"}}},description:"Function used to update the active cell coordinates",type:{name:"func"}},visibleColumns:{required:!1,tsType:{name:"Array",elements:[{name:"Column",elements:[{name:"object"}],raw:"Column<object>"}],raw:"Column<object>[]"},description:"Array of visible columns provided by react-table useTable hook",type:{name:"array"}}}};const un=()=>{const e=document.createElement("div");e.setAttribute("style","width: 100px; height: 100px; overflow: scroll; position:absolute; top:-9999px;"),document.body.appendChild(e);const t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t},ln=({placementElement:e,coords:t,addToHeader:a=!1,contextRef:r,blockClass:s=`${ue.prefix}--data-spreadsheet`,onActiveCellChange:l,activeCellValue:o,activeCellRef:m,cellEditorRef:u,defaultColumn:y})=>{if(!t)return;const p=document.querySelector(`[data-row-index="${t.row}"][data-column-index="${t.column}"]`)||document.querySelector(`.${s}__body--td`),g=p.offsetWidth,d=p.offsetHeight,A=a?r==null?void 0:r.current.querySelector(`.${s}__header--container`):r==null?void 0:r.current.querySelector(`.${s}__list--container`).firstElementChild,i={top:e?e.getBoundingClientRect().top-A.getBoundingClientRect().top:t.row===0?0:d*t.row,left:e?e.getBoundingClientRect().left-A.getBoundingClientRect().left:t.column===0?0+(y.rowHeaderWidth-4):g*t.column+(y.rowHeaderWidth-4)},_=m==null?void 0:m.current;_.style.width=Z(e?e==null?void 0:e.offsetWidth:g),_.style.height=Z(e?e==null?void 0:e.offsetHeight:d),_.style.left=Z(i.left),_.style.top=Z(i.top),_.style.display="block",_.setAttribute("data-active-row-index",typeof(t==null?void 0:t.row)=="number"?t.row:"header"),_.setAttribute("data-active-column-index",typeof(t==null?void 0:t.column)=="number"?t.column:"header"),A.appendChild(_),_.focus(),a||A.appendChild(u.current),typeof(t==null?void 0:t.column)=="number"&&typeof(t==null?void 0:t.row)=="number"&&(l==null||l(o))},Te=e=>Number(e.replace("rem","")*kt),mn=e=>{switch(e){case"xs":return Te(Nt);case"sm":return Te(Ce);case"md":return Te(Pt);case"lg":return Te(Lt);default:return Te(Ce)}},dn=({activeCellCoordinates:e,cellEditorRulerRef:t,columns:a,previousState:r,removeCellEditor:s,rows:l,setActiveCellCoordinates:o,setCurrentMatcher:m,setSelectionAreas:u,spreadsheetRef:y,updateData:p})=>g=>{const{key:d}=g,A=({type:i})=>{const _=()=>{const D=r==null?void 0:r.activeCellCoordinates,I=l[D==null?void 0:D.row].cells[D==null?void 0:D.column];s(),p(D==null?void 0:D.row,I.column.id)};me({spreadsheetRef:y}),_();const M=$e(),x={row:i==="Enter"?e.row===l.length-1?e.row:e.row+1:e.row,column:i==="Tab"?e.column===a.length-1?e.column:e.column+1:e.column};u([{point1:x,point2:x,matcher:M,areaCreated:!1}]),m(M),t.current.textContent=""};d==="Enter"&&(A({type:"Enter"}),o(i=>({...i,row:i.row===l.length-1?i.row:i.row+1}))),d==="Tab"&&(g.preventDefault(),A({type:"Tab"}),o(i=>({...i,column:i.column===a.length-1?i.column:i.column+1})))},re=`${ue.prefix}--data-spreadsheet`,Ke="DataSpreadsheet",xe={columns:Object.freeze([]),data:Object.freeze([]),defaultEmptyRowCount:16,onDataUpdate:Object.freeze(()=>{}),onActiveCellChange:Object.freeze(()=>{}),onSelectionAreaChange:Object.freeze(()=>{}),theme:"light"};let de=Vt.forwardRef(({cellSize:e="sm",className:t,columns:a=xe.columns,data:r=xe.data,defaultEmptyRowCount:s=xe.defaultEmptyRowCount,onDataUpdate:l=xe.onDataUpdate,id:o,onActiveCellChange:m=xe.onActiveCellChange,onSelectionAreaChange:u=xe.onSelectionAreaChange,selectAllAriaLabel:y,spreadsheetAriaLabel:p,theme:g,totalVisibleColumns:d,...A},i)=>{const _=w.useRef(null),M=w.useRef(),x=i||M,D=Gt(),[I,q]=w.useState(!1),[n,H]=w.useState(null),[k,j]=w.useState([]),[F,ee]=w.useState([]),[J,P]=w.useState(!1),[h,V]=w.useState(""),[O,B]=w.useState(!1),[N,z]=w.useState(""),[Y,se]=w.useState(!1),[le,fe]=w.useState(!1),[te,ce]=w.useState(!1),Q=Le({activeCellCoordinates:n,isEditing:O})||{},ne=mn(e),f=w.useRef(),[L,W]=w.useState(),U=w.useRef(),T=w.useRef(),E=w.useMemo(()=>({width:150,rowHeaderWidth:64,rowHeight:ne}),[ne]),{keysPressedList:oe,usingMac:he}=Ft({ref:_,containerHasFocus:I,isEditing:O}),Ne=w.useMemo(()=>un(),[]),{getTableProps:Ve,getTableBodyProps:St,headerGroups:Xe,rows:R,totalColumnsWidth:At,prepareRow:_t,setColumnOrder:It,visibleColumns:We}=Be.useTable({columns:a,data:r,defaultColumn:E},Be.useBlockLayout,Be.useColumnOrder),Ie=w.useCallback((S,b,K)=>{l(G=>G.map((v,pe)=>pe===S?{...G[S],[b]:N||K}:v))},[N,l]),Me=w.useCallback(()=>{var b;const S=(b=x==null?void 0:x.current)==null?void 0:b.querySelector(`.${re}__active-cell--highlight`);S&&(S.style.display="none")},[x]),be=w.useCallback(()=>{z(""),B(!1),f!=null&&f.current&&(f.current.style.display="none")},[]);w.useEffect(()=>{const S=Q==null?void 0:Q.activeCellCoordinates;if(((S==null?void 0:S.row)!==(n==null?void 0:n.row)||(S==null?void 0:S.column)!==(n==null?void 0:n.column))&&O){const b=R[Number(S==null?void 0:S.row)].cells[Number(S==null?void 0:S.column)];be(),Ie(S==null?void 0:S.row,b.column.id,void 0),T!=null&&T.current&&(T.current.textContent="")}if((S==null?void 0:S.row)!==(n==null?void 0:n.row)||(S==null?void 0:S.column)!==(n==null?void 0:n.column)){if(n&&(n==null?void 0:n.row)!=="header"&&(n==null?void 0:n.column)!=="header"){const b=typeof(n==null?void 0:n.column)=="number"&&typeof(n==null?void 0:n.row)=="number"?R[n==null?void 0:n.row].cells[n==null?void 0:n.column]:null;W((b==null?void 0:b.render("Cell"))??null)}(n&&(n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header")&&(W(null),fe(b=>!b))}},[n,Q==null?void 0:Q.activeCellCoordinates,Ie,R,O,be,L]);const Tt=w.useCallback(({placementElement:S,coords:b,addToHeader:K=!1})=>{const G=typeof(b==null?void 0:b.column)=="number"&&typeof(b==null?void 0:b.row)=="number"?R[b==null?void 0:b.row].cells[b==null?void 0:b.column]:null,v=G?Object.values(G.row.values)[b==null?void 0:b.column]:null;ln({placementElement:S,coords:b,addToHeader:K,contextRef:x,blockClass:re,onActiveCellChange:m,activeCellValue:v,activeCellRef:U,cellEditorRef:f,defaultColumn:E})},[x,R,m,E]);Qt({focusedElement:D,removeActiveCell:Me,setContainerHasFocus:q}),Yt({spreadsheetRef:x,setActiveCellCoordinates:H,setSelectionAreas:j,removeActiveCell:Me,setContainerHasFocus:q,removeCellEditor:be}),Jt({spreadsheetRef:x,activeCellCoordinates:n,containerHasFocus:I,createActiveCell:Tt,activeCellContent:L,isActiveHeaderCellChanged:le});const Ge=w.useCallback(()=>{ce(!1),n||H({column:"header",row:"header"})},[n]),we=w.useCallback(({coords:S={...n},updatedValue:b,optOutOfSelectionAreaUpdate:K=!1})=>{const G={...S,...b};if(H(G),G.row!=="header"&&G.column!=="header"&&!K){const v=$e();j([{point1:G,matcher:v}]),V(v)}},[n]),Je=w.useCallback(({type:S})=>{const b={...n};we({coords:b,updatedValue:{column:S==="Home"?0:a.length-1}}),me({matcher:void 0,spreadsheetRef:x})},[n,we,x,a.length]),Qe=w.useCallback(S=>O||S==="Meta"||S==="Control",[O]),Ye=w.useCallback(S=>{event==null||event.preventDefault(),Ge();const b={...n};let K;switch(S){case"ArrowLeft":{if(b.column==="header")return;typeof b.column=="number"&&(b.column===0?K={column:"header"}:K={column:b.column-1});break}case"ArrowUp":{if(b.row==="header")return;typeof b.row=="number"&&(b.row===0?K={row:"header"}:K={row:b.row-1});break}case"ArrowRight":{if(b.column==="header"&&(K={column:0}),typeof b.column=="number"){if(a.length-1===b.column)return;K={column:b.column+1}}break}case"ArrowDown":{if(b.row==="header"&&(K={row:0}),typeof b.row=="number"){if(R.length-1===b.row)return;K={row:b.row+1}}break}}K&&we({coords:b,updatedValue:K})},[Ge,we,n,a,R]),$t=w.useCallback(S=>{cn(S,te,we,n,Me,a,R,x,h,be,k,Je,oe,he,Ie,Qe,Ye,j,ee,V,U,H,q,W)},[te,we,n,Me,a,R,x,h,be,k,Je,oe,he,Ie,Qe,Ye]),Ze=()=>{var K,G,v,pe;B(!0),P(!1);const S=typeof(n==null?void 0:n.column)=="number"&&typeof(n==null?void 0:n.row)=="number"?R[n==null?void 0:n.row].cells[n==null?void 0:n.column]:null;let b;S&&(n!=null&&n.column)&&(b=S?(G=(K=S.row.cells)==null?void 0:K[n==null?void 0:n.column])==null?void 0:G.value:null),z(b||""),T!=null&&T.current&&(T.current.textContent=b),f!=null&&f.current&&(U!=null&&U.current)&&(f.current.style.width=(pe=(v=U==null?void 0:U.current)==null?void 0:v.style)==null?void 0:pe.width)};w.useEffect(()=>{var S,b,K,G,v,pe;O&&!(Q!=null&&Q.isEditing)&&((v=f==null?void 0:f.current)==null||v.setSelectionRange(Number((b=(S=T==null?void 0:T.current)==null?void 0:S.textContent)==null?void 0:b.length),Number((G=(K=T==null?void 0:T.current)==null?void 0:K.textContent)==null?void 0:G.length)),(pe=f==null?void 0:f.current)==null||pe.focus())},[O,Q==null?void 0:Q.isEditing]);const Ht=()=>{if((n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header"){const S=(n==null?void 0:n.row)==="header"?n==null?void 0:n.column:n==null?void 0:n.row;if((n==null?void 0:n.row)==="header"&&(n==null?void 0:n.column)==="header")return;Re({isKeyboard:!1,index:Number(S)})}},Mt=()=>{P(!1)},qt=()=>{if((n==null?void 0:n.row)!=="header"||(n==null?void 0:n.column)!=="header"){const S=$e();P(!0),me({matcher:null,spreadsheetRef:x}),j([{point1:n,matcher:S}]),V(S),ee([]),ce(!1)}},Dt=S=>{const{key:b}=S;b==="Enter"&&!te&&((n==null?void 0:n.column)!=="header"&&(n==null?void 0:n.row)!=="header"&&Ze(),((n==null?void 0:n.row)==="header"||(n==null?void 0:n.column)==="header")&&Re({isKeyboard:!0}))},Re=({isKeyboard:S,index:b=-1})=>{const K={activeCellCoordinates:n,rows:R,columns:a,currentMatcher:h,setActiveCellCoordinates:H,setCurrentMatcher:V,setSelectionAreas:j,spreadsheetRef:x,index:b,isKeyboard:S,setSelectionAreaData:ee,isHoldingCommandKey:null,isHoldingShiftKey:null};(n==null?void 0:n.row)==="header"&&(n==null?void 0:n.column)!=="header"&&ke({type:"column",...K}),(n==null?void 0:n.column)==="header"&&(n==null?void 0:n.row)!=="header"&&ke({type:"row",...K}),(n==null?void 0:n.column)==="header"&&(n==null?void 0:n.row)==="header"&&gt({ref:x,setCurrentMatcher:V,setSelectionAreas:j,rows:R,columns:a,activeCellCoordinates:n,updateActiveCellCoordinates:we})},jt=()=>{Ze()};Zt({isEditing:O,rows:R,activeCellCoordinates:n,activeCellRef:U,cellEditorRef:f,cellEditorRulerRef:T,visibleColumns:We,defaultColumn:E,cellEditorValue:N});const ve=w.useCallback((S,b)=>{h&&S&&S.length&&b&&h&&j(K=>{const G=ae(K),v=G.findIndex(pe=>pe.matcher===h);return v===-1?K:typeof G[v].point2=="object"&&G[v].areaCreated?(G[v].point2=G[v].point1,G[v].areaCreated=!1,ce(!1),me({matcher:h,spreadsheetRef:x}),G):K})},[x,h]),Ot=w.useCallback(()=>{ve(k,J)},[J,k,ve]);return $.jsx("div",{...A,...Ve(),...Xt(Ke),className:ie(re,t,`${re}--interactive-cell-element`,{[`${re}__container-has-focus`]:I,[`${re}__${g}`]:g==="dark"}),ref:x,role:"grid",tabIndex:0,"aria-rowcount":(R==null?void 0:R.length)||0,"aria-colcount":(a==null?void 0:a.length)||0,"aria-label":p,onKeyDown:$t,onFocus:()=>q(!0),children:$.jsxs("div",{ref:_,children:[$.jsx(Ue,{ref:x,activeCellCoordinates:n,cellSize:e,columns:a,currentMatcher:h,defaultColumn:E,headerGroups:Xe,rows:R,scrollBarSize:Ne,selectionAreas:k,setActiveCellCoordinates:H,setSelectionAreas:j,setCurrentMatcher:V,setSelectionAreaData:ee,totalVisibleColumns:d,updateActiveCellCoordinates:we,setHeaderCellHoldActive:se,headerCellHoldActive:Y,visibleColumns:We,selectAllAriaLabel:y}),$.jsx(Ee,{activeCellRef:U,activeCellCoordinates:n,ref:x,clickAndHoldActive:J,setClickAndHoldActive:P,currentMatcher:h,setCurrentMatcher:V,setContainerHasFocus:q,selectionAreas:k,setSelectionAreas:j,headerGroups:Xe,defaultColumn:E,getTableBodyProps:St,onDataUpdate:l,onActiveCellChange:m,onSelectionAreaChange:u,prepareRow:_t,rows:R,selectionAreaData:F,setSelectionAreaData:ee,setActiveCellCoordinates:H,scrollBarSize:Ne,totalColumnsWidth:At,id:o,columns:a,defaultEmptyRowCount:s,setActiveCellInsideSelectionArea:ce,totalVisibleColumns:d,setHeaderCellHoldActive:se,setColumnOrder:It,visibleColumns:We}),$.jsx("button",{onMouseDown:qt,onMouseUp:Mt,onClick:Ht,onKeyDown:Dt,onDoubleClick:jt,onMouseEnter:Ot,ref:U,className:ie(`${re}--interactive-cell-element`,`${re}__active-cell--highlight`,{[`${re}__active-cell--with-selection`]:te}),type:"button",children:L}),$.jsx("textarea",{id:`${re}__cell-editor-text-area`,value:N,onKeyDown:dn({activeCellCoordinates:n,cellEditorRulerRef:T,columns:a,previousState:Q,removeCellEditor:be,rows:R,setActiveCellCoordinates:H,setCurrentMatcher:V,setSelectionAreas:j,spreadsheetRef:x,updateData:Ie}),onChange:S=>{z(S.target.value),T!=null&&T.current&&(T.current.textContent=S.target.value)},ref:f,"aria-labelledby":n?`${re}__cell--${n==null?void 0:n.row}--${n==null?void 0:n.column}`:"",className:ie(`${re}__cell-editor`,`${re}--interactive-cell-element`,`${re}__cell-editor--${e}`,{[`${re}__cell-editor--active`]:O})}),$.jsx("pre",{"aria-hidden":!0,ref:T,className:`${re}__cell-editor-ruler`})]})})});de=ue.checkComponentEnabled(de,Ke);de.displayName=Ke;de.propTypes={cellSize:c.oneOf(["xs","sm","md","lg"]),className:c.string,columns:c.arrayOf(c.shape({Header:c.string,accessor:c.oneOfType([c.string,c.func]),Cell:c.func})),data:c.arrayOf(c.shape),defaultEmptyRowCount:c.number,id:c.oneOfType([c.number,c.string]),onActiveCellChange:c.func,onDataUpdate:c.func,onSelectionAreaChange:c.func,selectAllAriaLabel:c.string.isRequired,spreadsheetAriaLabel:c.string.isRequired,theme:c.oneOf(["light","dark"]),totalVisibleColumns:c.number};de.__docgenInfo={description:"DataSpreadsheet: used to organize and display large amounts of structured data, separated by columns and rows in a grid-like format.",methods:[],displayName:"DataSpreadsheet",props:{cellSize:{required:!1,tsType:{name:"union",raw:"'xs' | 'sm' | 'md' | 'lg'",elements:[{name:"literal",value:"'xs'"},{name:"literal",value:"'sm'"},{name:"literal",value:"'md'"},{name:"literal",value:"'lg'"}]},description:"Specifies the cell height",defaultValue:{value:"'sm'",computed:!1},type:{name:"enum",value:[{value:"'xs'",computed:!1},{value:"'sm'",computed:!1},{value:"'md'",computed:!1},{value:"'lg'",computed:!1}]}},className:{required:!1,tsType:{name:"string"},description:"Provide an optional class to be applied to the containing node.",type:{name:"string"}},columns:{required:!1,tsType:{name:"unknown"},description:"The data that will build the column headers",defaultValue:{value:"Object.freeze([])",computed:!0},type:{name:"arrayOf",value:{name:"shape",value:{Header:{name:"string",required:!1},accessor:{name:"union",value:[{name:"string"},{name:"func"}],required:!1},Cell:{name:"func",required:!1}}}}},data:{required:!1,tsType:{name:"unknown"},description:"The spreadsheet data that will be rendered in the body of the spreadsheet component",defaultValue:{value:"Object.freeze([])",computed:!0},type:{name:"arrayOf",value:{name:"shape",value:"",computed:!0}}},defaultEmptyRowCount:{required:!1,tsType:{name:"number"},description:"Sets the number of empty rows to be created when there is no data provided",defaultValue:{value:"16",computed:!1},type:{name:"number"}},id:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"The spreadsheet id",type:{name:"union",value:[{name:"number"},{name:"string"}]}},onActiveCellChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the active cell changes",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onDataUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"({ ...args }) => void",signature:{arguments:[{name:""}],return:{name:"void"}}},description:"The setter fn for the data prop",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},onSelectionAreaChange:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"The event handler that is called when the selection area values change",defaultValue:{value:"Object.freeze(() => {})",computed:!0},type:{name:"func"}},selectAllAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Select all button",type:{name:"string"}},spreadsheetAriaLabel:{required:!0,tsType:{name:"string"},description:"The aria label applied to the Data spreadsheet component",type:{name:"string"}},theme:{required:!1,tsType:{name:"union",raw:"'light' | 'dark'",elements:[{name:"literal",value:"'light'"},{name:"literal",value:"'dark'"}]},description:"The theme the DataSpreadsheet should use (only used to render active cell/selection area colors on dark theme)",type:{name:"enum",value:[{value:"'light'",computed:!1},{value:"'dark'",computed:!1}]}},totalVisibleColumns:{required:!1,tsType:{name:"number"},description:`The total number of columns to be initially visible, additional columns will be rendered and
visible via horizontal scrollbar`,type:{name:"number"}}}};const rt=["dog","cat","bird","lizard","frog","hamster","fish","rabbit","snake"],qe=["Bruno","Willow","Kona","Heidi","Rusty","Bonnie","Cash","Gucci","Brody","Emma","Loki","Angel","Astro","Sherman","Layla","Peanut","Grace","Mickey","Sasha","Finn","Tucker","Bear","Mocha","Roscoe"],hn=e=>{const t=[];for(let a=0;a<e;a++)t.push(a);return t},pn=e=>{const t=e&&{ownerName:qe[Math.floor(Math.random()*qe.length)],weight:Math.floor(Math.random()*40)},a={petType:rt[Math.floor(Math.random()*rt.length)],firstName:qe[Math.floor(Math.random()*qe.length)],age:Math.floor(Math.random()*30),visits:Math.floor(Math.random()*40),health:Math.floor(Math.random()*100)};return e?{...a,...t}:a},Fe=({rows:e,extraColumns:t})=>((r=0)=>{const l=[e][r];return hn(l).map(()=>({...pn(t)}))})();function at(e){const t={a:"a",h1:"h1",h2:"h2",li:"li",ul:"ul",...yt(),...e.components};return $.jsxs($.Fragment,{children:[$.jsx(t.h1,{id:"dataspreadsheet",children:"DataSpreadsheet"}),`
`,$.jsx(t.h2,{id:"table-of-contents",children:"Table of Contents"}),`
`,$.jsxs(t.ul,{children:[`
`,$.jsx(t.li,{children:$.jsx(t.a,{href:"#overview",children:"Overview"})}),`
`,$.jsx(t.li,{children:$.jsx(t.a,{href:"#example-usage",children:"Example usage"})}),`
`,$.jsx(t.li,{children:$.jsx(t.a,{href:"#component-api",children:"Component API"})}),`
`]}),`
`,$.jsx(t.h2,{id:"overview",children:"Overview"}),`
`,`
`,$.jsx(t.h2,{id:"example-usage",children:"Example usage"}),`
`,`
`,$.jsx(Wt,{children:$.jsx(Bt,{of:ye})}),`
`,$.jsx(t.h2,{id:"code-sample",children:"Code sample"}),`
`,`
`,$.jsx(t.h2,{id:"component-api",children:"Component API"}),`
`,$.jsx(zt,{})]})}function fn(e={}){const{wrapper:t}={...yt(),...e.components};return t?$.jsx(t,{...e,children:$.jsx(at,{...e})}):at(e)}const wn="div[data-story-title*=DataSpreadsheet] .docs-story>div:first-child>div:first-child{overflow:auto;width:100%}",Gn={title:"IBM Products/Components/Data spreadsheet/DataSpreadsheet",component:de,tags:["autodocs"],argTypes:{onActiveCellChange:{action:"active cell change"},onSelectionAreaChange:{action:"selection area change"}},parameters:{styles:wn,docs:{page:fn}}},De=({value:e})=>$.jsx("span",{style:{display:"flex",justifyContent:"flex-end"},children:e}),Pe=[{Header:"Row Index",accessor:(e,t)=>t,Cell:({cell:{value:e}})=>$.jsx(De,{value:e}),placement:"right",width:275},{Header:"Pet type",accessor:"petType"},{Header:"First Name",accessor:"firstName"},{Header:"Age",accessor:"age",Cell:({cell:{value:e}})=>$.jsx(De,{value:e}),placement:"right"},{Header:"Vet visits",accessor:"visits",Cell:({cell:{value:e}})=>$.jsx(De,{value:e}),placement:"right"},{Header:"Health",accessor:"health",Cell:({cell:{value:e}})=>$.jsx(De,{value:e}),placement:"right"}],yn=({...e})=>{const[t,a]=w.useState(()=>Fe({rows:16})),r=w.useMemo(()=>Pe,[]);return $.jsx(de,{columns:r,data:t,onDataUpdate:a,id:"spreadsheet--id",...e})},gn=({...e})=>{const[t,a]=w.useState(()=>Fe({rows:1e3})),r=w.useMemo(()=>Pe,[]);return $.jsx(de,{columns:r,data:t,onDataUpdate:a,id:"spreadsheet--id",...e})},bn=({...e})=>{const[t,a]=w.useState([]),r=w.useMemo(()=>[...Pe.filter(l=>l.Header!=="Row Index")],[]),s=w.useMemo(()=>r,[r]);return $.jsx(de,{columns:s,data:t,onDataUpdate:a,id:"spreadsheet--id",...e})},xn=({...e})=>{const[t,a]=w.useState(()=>Fe({rows:24,extraColumns:!0})),r=w.useMemo(()=>[...Pe,{Header:"Owner name",accessor:"ownerName"},{Header:"Weight",accessor:"weight"}],[]),s=w.useMemo(()=>r,[r]);return $.jsx(de,{columns:s,data:t,onDataUpdate:a,id:"spreadsheet--id",...e})},ye=yn.bind({});ye.storyName="Basic spreadsheet";ye.args={selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const Se=gn.bind({});Se.storyName="Large dataset";Se.args={cellSize:"lg",selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const Ae=bn.bind({});Ae.storyName="Empty with cells";Ae.args={defaultEmptyRowCount:24,selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet"};const _e=xn.bind({});_e.storyName="With many columns";_e.args={selectAllAriaLabel:"Select all",spreadsheetAriaLabel:"Example data spreadsheet",totalVisibleColumns:5};var st,ot,ct;ye.parameters={...ye.parameters,docs:{...(st=ye.parameters)==null?void 0:st.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 16
  }));
  const columns = useMemo(() => columnData, []);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(ct=(ot=ye.parameters)==null?void 0:ot.docs)==null?void 0:ct.source}}};var ut,it,lt;Se.parameters={...Se.parameters,docs:{...(ut=Se.parameters)==null?void 0:ut.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 1000
  }));
  const columns = useMemo(() => columnData, []);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(lt=(it=Se.parameters)==null?void 0:it.docs)==null?void 0:lt.source}}};var mt,dt,ht;Ae.parameters={...Ae.parameters,docs:{...(mt=Ae.parameters)==null?void 0:mt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState([]);
  const columnDataClone = useMemo(() => [...columnData.filter(item => item.Header !== 'Row Index')], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(ht=(dt=Ae.parameters)==null?void 0:dt.docs)==null?void 0:ht.source}}};var pt,ft,wt;_e.parameters={..._e.parameters,docs:{...(pt=_e.parameters)==null?void 0:pt.docs,source:{originalSource:`({
  ...args
}) => {
  const [data, setData] = useState(() => generateData({
    rows: 24,
    extraColumns: true
  }));
  const columnDataClone = useMemo(() => [...columnData, {
    Header: 'Owner name',
    accessor: 'ownerName'
  }, {
    Header: 'Weight',
    accessor: 'weight'
  }], []);
  const columns = useMemo(() => columnDataClone, [columnDataClone]);
  return <DataSpreadsheet columns={columns} data={data} onDataUpdate={setData} id="spreadsheet--id" {...args} />;
}`,...(wt=(ft=_e.parameters)==null?void 0:ft.docs)==null?void 0:wt.source}}};const Jn=["dataSpreadsheet","largeDatasetSpreadsheet","emptyWithCells","withManyColumns"];export{Jn as __namedExportsOrder,ye as dataSpreadsheet,Gn as default,Ae as emptyWithCells,Se as largeDatasetSpreadsheet,_e as withManyColumns};
